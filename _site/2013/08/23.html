<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="description" content="CoffeeScript 可以避免 Java 形式的代码的重复和冗余，让你像写 Ruby 代码一样精简而优美的写 Javascript" />
    <meta name="author" content="唐久军">
    
    <link rel="shortcut icon" href="/assets/img/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" type="text/css" href="/assets/css/blog.css">
    <script type="text/javascript" src="/assets/js/blog.js"></script>

    <title>Coffeescript 基础语法笔记</title>

    <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-39325120-3']);
        _gaq.push(['_trackPageview']);

        (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
      </script>

  </head>

  <body>
<div class="nav nav-fix-top">
    <div class="navbar-panel">
        <div class="brand">
            <a href="/" class="light">唐久军的博客</a>
        </div>

        <div class="catalog pull-right">
            <ul>
                <li><a href="/categories.html">分类</a></li>
                <li><a href="/tags.html">标签</a></li>
                <li><a href="/projects.html">项目</a></li>
                <li><a href="/archives.html">归档</a></li>
                <li><a href="/about_me.html">关于我</a></li>
            </ul>
        </div>
    </div>
</div>

<!-- 防止 IE6、7 中定位元素导致相邻元素 margin-top 失效 -->
<div style="height: 0px"></div>
  <div class="well well-header">
      <ul>
          <li  class="badge badge-info badge-large pull-right">
            <a href="/categories.html?#anchorjavascript">分类：javascript</a></li>
      </ul>
      <ul>
        
          <li  class="badge badge-inverse pull-right">
              <a href="/tags.html?#anchorCoffeeScript">CoffeeScript</a>
          </li>
        
          <li  class="badge badge-inverse pull-right">
              <a href="/tags.html?#anchorJavaScript">JavaScript</a>
          </li>
        
      </ul>

      <a class="time-backgroud"></a>
      <span class="time-meta">2013年08月23日</span>
      <h1>Coffeescript 基础语法笔记</h1>
      <hr>
      <p>CoffeeScript 可以避免 Java 形式的代码的重复和冗余，让你像写 Ruby 代码一样精简而优美的写 Javascript</p>
  </div>

  <div class="well">
    <h3>本地执行环境搭建</h3>

<ol>
<li><p>安装 nodejs</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">sudo add-apt-repository ppa:chris-lea/node.js
sudo apt-get update
sudo apt-get install nodejs
</code></pre></div>
<ol>
<li><p>安装 CoffeeScript</p>

<p>sudo npm install coffee-script</p></li>
</ol></li>
</ol>

<h3>变量定义</h3>

<ol>
<li><p>创建变量, CoffeeScript 在变量赋值前，自动为变量添加 var</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">for = &#39;far&#39;
</code></pre></div></li>
<li><p>创建全局变量（在顶级作用越中，this 相当与全局对象）</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">global = this
global.for = bar    # 执行这两句代码后，就全局变量 for 等于 bar 了
</code></pre></div></li>
</ol>

<h3>函数定义</h3>

<ol>
<li><p>用 <code>-&gt;</code> 定义一个 function，并自动把在函数最后一行加上 return</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">func = -&gt;
  &#39;return value&#39;
</code></pre></div></li>
<li><p>函数参数</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">func = (x, y) -&gt;
func = (x = 1, y = 2) -&gt;
func = (x, y...) -&gt;        # y 是一个数组
</code></pre></div></li>
<li><p>使用 <code>=&gt;</code> 定义函数，来绑定函数定义时的上下文环境到函数中</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">func = (x) =&gt;
</code></pre></div></li>
</ol>

<h3>流程控制</h3>

<ol>
<li><p>if 表达式</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text"># CoffeeScript 不支持三目运算符，可以这样替代
if 1 &gt; 0 then &#39;yes&#39; else &#39;no&#39;
</code></pre></div></li>
<li><p>说明：可以使用 not 来替代感叹号（！）, 使用 is 编译过后就是 ===， 使用 isnt 来代替 is not 以增加可读性；CoffeeScript 会自动把 == 操作符转化为 ===，把 != 转化为 !==</p></li>
</ol>

<h3>字符串插值</h3>

<p>CoffeeScript 支持 Ruby 风格的字符串插值方式</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">name = &#39;tom&#39;
user = &quot;name: #{name}&quot;
</code></pre></div>
<h3>循环和列表解析</h3>

<p>循环返回一个由循环最后一行的值组成的数组</p>

<ol>
<li><p>使用 for x in array</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">for name in [&#39;tom&#39;, &#39;jack&#39;, &#39;marry&#39;]
  alert name
# 上面方式可以简写成：
alert name for name in [&#39;tom&#39;, &#39;jack&#39;, &#39;marry&#39;]
</code></pre></div></li>
<li><p>循环加入索引</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">alert &quot;#{name} - #{i}&quot; for name, i in [&#39;tom&#39;, &#39;jack&#39;, &#39;marry&#39;]
</code></pre></div></li>
<li><p>数组循环的过滤</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">alert &quot;#{name} - #{i}&quot; for name, i in [&#39;tom&#39;, &#39;jack&#39;, &#39;marry&#39;] when i &lt; 2
</code></pre></div></li>
<li><p>使用 of 替代 in 关键字来迭代对象的全部属性，像 Ruby 中的 hash 迭代一样</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">names =
  tom: &#39;man&#39;
  marry: &#39;woman&#39;

for name, sex of names
  alert &quot;#{name} - #{sex}&quot;
</code></pre></div></li>
<li><p>也可以使用 CoffeeScript 唯一暴露的顶层循环 while</p></li>
</ol>

<h3>数组</h3>

<ol>
<li><p>受 Ruby 影响，CoffeeScript 可以使用两个数组来定义区间</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">range = [1..3]   # range = [1,2,3]
</code></pre></div></li>
<li><p>分割一个数组（如果一个区间被指定到一个数组之后，CoffeeScript 会将其转换为一个 slice() 调用）</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">variable = [&quot;one&quot;, &quot;two&quot;, &quot;three&quot;][0..1]    # variable = [&quot;one&quot;, &quot;two&quot;]
</code></pre></div></li>
<li><p>替换数组片段的值</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">numbers = [1..4]
numbers[1..2] = [-1, -2]    # numbers = [1, -1, -2, 4]
</code></pre></div></li>
<li><p>在字符串上也可以使用区间来获得一个新的子字符串</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">str = &#39;test&#39;[0..1]    # str = &#39;te&#39;
</code></pre></div></li>
<li><p>检测数组是否存在某个值，使用 <code>in</code> 操作符</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">strs = [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]
console.log &#39;a&#39; if &#39;a&#39; in strs
</code></pre></div></li>
</ol>

<h3>存在检查</h3>

<p>CoffeeScript 存在操作符 <code>?</code> 只会在变量不为 <code>null</code> 或者 <code>undefined</code> 的时候会返回 <code>true</code>，与 Ruby 的 nil? 类似</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">true if name?
</code></pre></div>
<p>还可以使用 <code>?</code> 来替代 <code>||</code> 操作符</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">default = name ? &#39;tom&#39;    # &#39;tom&#39;
</code></pre></div>
<p>如果要在访问属性，函数之前进行 <code>null</code> 检查，我们可以吧 <code>?</code> 放在调用的属性方法的左边来跳过编译时的语法检查，这与 Rails 的 try 方法相似</p>

  </div>

  <!-- 底部导航条 -->
  <div class="nav nav-fix-bottom"  id="nav-fix-bottom">
      <div class="navbar-panel">
          <div id="page-nav-list" class="catalog pull-left"></div>
      </div>
  </div>

  <link rel="stylesheet" type="text/css" href="/assets/css/monokai.min.css">
  <script type="text/javascript" src="/assets/js/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

<!-- duoshuo div -->
<div class="well">
  <div class="ds-thread"></div>
</div>

<!-- Duoshuo Comment BEGIN -->
<script type="text/javascript">
  var duoshuoQuery = {short_name:"tang-blog"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = 'http://static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
  </script>
<!-- Duoshuo Comment END -->
<!-- Baidu Button BEGIN -->
<script type="text/javascript" id="bdshare_js" data="type=slide&amp;img=5&amp;mini=1&amp;pos=left&amp;uid=6635097" ></script>
<script type="text/javascript" id="bdshell_js"></script>
<script type="text/javascript">
document.getElementById("bdshell_js").src = "http://bdimg.share.baidu.com/static/js/shell_v2.js?cdnversion=" + Math.ceil(new Date()/3600000);
</script>
<!-- Baidu Button END -->
    <div class="footer">
      &copy; 2013 唐久军 - Crafted with 
        <a href="http://jekyllrb.com/"><strong>Jekyll</strong></a>, Hosted on 
        <strong><a href="https://github.com/">GitHub</a></strong>
        | 转载请遵守 <a href="http://creativecommons.org/licenses/by-sa/3.0/cn/">CC BY-SA 3.0</a> 协议
        <span class="pull-right">
          <strong>
            <a href="https://github.com/tangjiujun">Fork me on GitHub </a>
          </strong>
        </span>
    </div>
  </body>
</html>
